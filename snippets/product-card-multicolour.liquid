{% if product %}
  <a href="{{ product.url }}" class="product-card-link">
    <div class="product-card">
      <div class="product-card__image-wrapper">
        <div class="swiper product-card__slider">
          <div class="swiper-wrapper">
            {% assign unique_images = '' %}
            {% for variant in product.variants %}
              {% if variant.featured_image %}
                {% assign image_url = variant.featured_image | image_url: width: 500 %}
                {% unless unique_images contains image_url %}
                  {% assign unique_images = unique_images | append: image_url | append: ',' %}
                  <div class="swiper-slide">
                    <img
                      class="product-card__image"
                      src="{{ image_url }}"
                      alt="{{ product.title | escape }} - {{ variant.title }}"
                      width="500"
                      height="500"
                    >
                  </div>
                {% endunless %}
              {% endif %}
            {% endfor %}

            {% if product.variants.size == 1 %}
              <div class="swiper-slide">
                <img
                  class="product-card__image"
                  src="{{ product.featured_image | image_url: width: 500 }}"
                  alt="{{ product.title | escape }}"
                  width="500"
                  height="500"
                >
              </div>
            {% endif %}
          </div>

          <div class="product-card__information">
            {% if product.variants.size > 1 %}
              <div class="swiper-progress-bar"></div>
            {% endif %}
            <div class="product-card__content">
              <h4 class="product-card__title">{{ product.title }}</h4>
              <p class="product-card__price">{{ product.price | money }}</p>
            </div>
            {% if product.tags contains 'in-store' %}
              <span class="product-card__badge">In-store</span>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </a>
{% endif %}

<script>
  document.addEventListener('DOMContentLoaded', function () {
    new Swiper('.product-card__slider', {
      loop: true,
      speed: 500,
      effect: 'fade',
      simulateTouch: true,
      pagination: {
        el: '.swiper-progress-bar',
        type: 'progressbar',
        clickable: true,
      },
    });
  });
</script>
